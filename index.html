<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dominio y Rango de Funciones</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f8f8f8;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 10px 0;
    }
    #output {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>Calculadora de Dominio y Rango</h2>
  <p>Ingresa una función en términos de <code>x</code> (por ejemplo: <code>x*x - 4</code> o <code>2*x + 3</code>)</p>
  <input type="text" id="funcion" placeholder="Ingresa f(x)" />
  <button onclick="graficarFuncion()">Graficar</button>
  <div id="output"></div>
  <div id="grafico" style="width:100%;height:500px;"></div>

  <script>
    function graficarFuncion() {
      const expresion = document.getElementById("funcion").value;
      const output = document.getElementById("output");
      let x = [], y = [];

      try {
        // Genera valores de x entre -20 y 20
        for (let i = -20; i <= 20; i += 0.1) {
          x.push(i);
          // Evalúa la función con JavaScript
          let yi = eval(expresion.replace(/x/g, `(${i})`));
          y.push(yi);
        }

        const rangoMin = Math.min(...y);
        const rangoMax = Math.max(...y);

        output.innerHTML = `
          <p><strong>Dominio:</strong> [-20, 20]</p>
          <p><strong>Rango aproximado:</strong> [${rangoMin.toFixed(2)}, ${rangoMax.toFixed(2)}]</p>
        `;

        const trace = {
          x: x,
          y: y,
          mode: "lines",
          name: "f(x)",
          line: { color: "blue" }
        };

        const layout = {
          title: `Gráfica de f(x) = ${expresion}`,
          xaxis: { title: "x", range: [-20, 20] },
          yaxis: { title: "f(x)", range: [rangoMin - 5, rangoMax + 5] },
          margin: { t: 50 }
        };

        Plotly.newPlot("grafico", [trace], layout);
      } catch (error) {
        output.innerHTML = `<p style="color:red;">⚠️ Error en la expresión. Asegúrate de usar solo <code>x</code> y operadores válidos como <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>**</code>.</p>`;
      }
    }
  </script>
</body>
</html>
