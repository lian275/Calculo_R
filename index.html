<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Resoluci√≥n de Ecuaciones Lineales con Bot</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      padding: 20px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 10px 5px 10px 0;
    }
    #grafico {
      margin-top: 20px;
    }
    #bot-explica {
      background: #e0f7fa;
      padding: 15px;
      margin-top: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>

  <h2>üßÆ Resolver Ecuaciones Lineales + Dominio/Rango + Bot de Voz</h2>
  <p>Escribe una ecuaci√≥n lineal como: <code>2*x + 4 = 0</code></p>

  <input type="text" id="ecuacion" placeholder="Ej: 2*x + 4 = 0" size="30">
  <button onclick="resolverEcuacion()">Resolver</button>
  <button onclick="leerBot()">üîä Leer con Bot</button>

  <div id="resultado"></div>
  <div id="grafico"></div>
  <div id="bot-explica"></div>

  <script>
    let ultimaExplicacion = "";

    function resolverEcuacion() {
      const ecuacion = document.getElementById("ecuacion").value;
      const resultado = document.getElementById("resultado");
      const bot = document.getElementById("bot-explica");

      // Separar la ecuaci√≥n en izquierda y derecha
      const partes = ecuacion.split("=");
      if (partes.length !== 2) {
        resultado.innerHTML = "<p style='color:red;'>‚ùå Ecuaci√≥n inv√°lida. Usa el formato ax + b = 0</p>";
        return;
      }

      try {
        const izquierda = partes[0];
        const derecha = partes[1];

        // Creamos una funci√≥n f(x) = izquierda - derecha
        const f = x => eval(izquierda.replace(/x/g, `(${x})`)) - eval(derecha.replace(/x/g, `(${x})`));

        // Resolver ecuaci√≥n lineal f(x) = 0
        const a = eval(izquierda.replace(/x/g, '(1)')) - eval(izquierda.replace(/x/g, '(0)')); // derivada ‚âà coef x
        const b = eval(izquierda.replace(/x/g, '(0)')) - eval(derecha); // t√©rmino independiente

        let solucion = null;
        if (a === 0) {
          solucion = b === 0 ? "Infinitas soluciones" : "No tiene soluci√≥n";
        } else {
          solucion = -b / a;
        }

        // Dominio y rango de funci√≥n lineal
        const dominio = "‚Ñù (todos los reales)";
        const rango = "‚Ñù (todos los reales)";

        // Mostrar resultados
        resultado.innerHTML = `
          <p>üìò <strong>Funci√≥n asociada:</strong> f(x) = ${izquierda} - (${derecha})</p>
          <p>‚úÖ <strong>Soluci√≥n de la ecuaci√≥n:</strong> ${solucion}</p>
          <p>üìà <strong>Dominio:</strong> ${dominio}</p>
          <p>üìâ <strong>Rango:</strong> ${rango}</p>
        `;

        // Gr√°fico
        let x_vals = [], y_vals = [];
        for (let i = -20; i <= 20; i += 0.1) {
          x_vals.push(i);
          y_vals.push(f(i));
        }

        Plotly.newPlot("grafico", [{
          x: x_vals,
          y: y_vals,
          mode: 'lines',
          name: 'f(x)',
          line: { color: 'blue' }
        }], {
          title: "Gr√°fica de f(x)",
          xaxis: { title: 'x', range: [-20, 20] },
          yaxis: { title: 'f(x)' }
        });

        // Bot explicativo
        let explicacion = `ü§ñ Bot: Resolviste una ecuaci√≥n lineal: ${ecuacion}. `;
        if (typeof solucion === "string") {
          explicacion += `La ecuaci√≥n tiene: ${solucion}. `;
        } else {
          explicacion += `La soluci√≥n es x = ${solucion.toFixed(2)}. `;
        }
        explicacion += `El dominio y el rango de una funci√≥n lineal son todos los n√∫meros reales.`;

        bot.innerHTML = explicacion;
        ultimaExplicacion = explicacion;

      } catch (e) {
        resultado.innerHTML = "<p style='color:red;'>‚ùå Error al procesar la ecuaci√≥n. Verifica la sintaxis.</p>";
        Plotly.purge("grafico");
        bot.innerHTML = '';
      }
    }

    function leerBot() {
      if ('speechSynthesis' in window) {
        const utter = new SpeechSynthesisUtterance(ultimaExplicacion);
        utter.lang = "es-ES";
        utter.rate = 1;
        window.speechSynthesis.speak(utter);
      } else {
        alert("Tu navegador no soporta voz.");
      }
    }
  </script>

</body>
</html>
